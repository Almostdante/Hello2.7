__author__ = 'andreydmitriev'
test1 = [3453, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554, 34534, 23, 2222, 345363, 34664, 56757, 45345, 567567, 35, 2, 2, 22, 35345, 46456456456546456, 456456, 5, 394, 45, 34346, 5, 5756554]
test2 = [2, 4, 8, 6, 5, 7, 1, 3]
test3 = [4, 8, 2, 6, 5]


def qsort(arr, l, r, type):
    if len(arr[l:r]) <= 1:
        return
    if type == 'last':
        arr[l], arr[r-1] = arr[r-1], arr[l]
    if type == 'med':
        med_dict = {arr[l]: l, arr[r-1]: r-1, arr[(r-l+1)/2+l-1]: (r-l+1)/2+l-1}
        med_dict_keys = med_dict.keys()
        med_dict_keys.sort()
        arr[l], arr[med_dict[med_dict_keys[1]]] = arr[med_dict[med_dict_keys[1]]], arr[l]
    global cnt
    cnt = cnt + r - l - 1
    i = l + 1
    for j in range(l+1, r):
        if arr[j] < arr[l]:
            (arr[j], arr[i]) = (arr[i], arr[j])
            i += 1
    arr[l], arr[i-1] = arr[i-1], arr[l]
    qsort(arr, l, i-1, type)
    qsort(arr, i, r, type)
    return

for y in ['first', 'last', 'med']:
    test = []
    text = open('QuickSort1.txt').readlines()
    for x in text:
        test.append(int(x))
    cnt = 0
    qsort(test, 0, len(test), y)
    print test
    print cnt
